# 📊 15분봉 기술적 분석 지표 및 전략 정리

## 🎯 개요

15분봉이 완성될 때마다 자동으로 실행되는 기술적 분석 시스템의 모든 지표와 전략들을 정리한 문서입니다.

**실행 플로우:**

```
15분봉 완성 → candle.saved 이벤트 → TechnicalAnalysisEventService.handleCandleSaved()
→ ATR 계산 → 기본 전략 실행 → 고급 전략 실행 → 종합 분석 → 이벤트 발송
```

---

## 📈 1. 구현된 기술적 지표들

### 1.1 이동평균선 (Moving Averages)

- **SMA (Simple Moving Average)**: 5, 20, 50, 200기간
- **EMA (Exponential Moving Average)**: 12, 26기간
- **용도**: 트렌드 방향 확인, 지지/저항선, 가격 돌파 신호

### 1.2 모멘텀 지표

- **RSI (Relative Strength Index)**: 14기간
  - 과매수/과매도 구간 감지
  - 30 이하: 과매도 (매수 신호)
  - 70 이상: 과매수 (매도 신호)

- **MACD (Moving Average Convergence Divergence)**
  - MACD 라인: EMA12 - EMA26
  - 시그널 라인: MACD의 9기간 EMA
  - 히스토그램: MACD - 시그널
  - 골든크로스/데드크로스 신호 생성

### 1.3 변동성 지표

- **ATR (Average True Range)**: 14기간
  - 시장 변동성 측정
  - 손절/익절 거리 계산에 활용
  - ATR 배수 기반 동적 리스크 관리

- **볼린저 밴드 (Bollinger Bands)**: 20기간, 2표준편차
  - 상단/하단 밴드 돌파 신호
  - 밴드 수축/확장 패턴 감지
  - 평균 회귀 전략 기반

### 1.4 거래량 지표

- **VWAP (Volume Weighted Average Price)**
  - 거래량 가중 평균가
  - 일일 기준점 역할
  - 기관 투자자 참여도 측정

- **거래량 분석 (Volume Analysis)**
  - 평균 거래량 대비 현재 거래량 비율
  - 거래량 급증 패턴 감지
  - 가격-거래량 상관관계 분석

---

## 🎯 2. 구현된 전략들

### 2.1 기본 전략 (Basic Strategies)

#### 2.1.1 이동평균 크로스오버 전략

- **목적**: SMA20과 SMA50의 골든크로스/데드크로스 감지
- **신호**:
  - 골든크로스 (SMA20 > SMA50): STRONG_BUY
  - 데드크로스 (SMA20 < SMA50): STRONG_SELL
- **보조 조건**: 거래량 1.5배 이상 시 신호 강화

#### 2.1.2 볼린저 밴드 반전 전략

- **목적**: 밴드 상단/하단 돌파 후 반전 감지
- **신호**:
  - 하단 밴드 터치 후 반등: BUY
  - 상단 밴드 터치 후 하락: SELL
- **특징**: 평균 회귀 기반 반전 신호

#### 2.1.3 MACD 크로스오버 전략

- **목적**: MACD와 시그널 라인의 교차 감지
- **신호**:
  - MACD > 시그널 (골든크로스): BUY
  - MACD < 시그널 (데드크로스): SELL
- **추가**: 히스토그램 변화량 분석

#### 2.1.4 피벗 반전 전략 ⭐ **실제 사용 중**

- **목적**: 피벗 포인트 기반 반전 신호 감지
- **조건** (3개 중 2개 만족 시 진입):
  1. 피벗 포인트 터치/돌파
  2. RSI 과매수(70+)/과매도(30-) 구간
  3. 거래량 급증 (평균 대비 1.5배+)
- **신호**: LONG/SHORT 포지션 진입
- **특징**: 현재 자동매매 시스템의 핵심 진입 전략

#### 2.1.5 삼중 확인 전략

- **목적**: 3가지 조건 동시 확인으로 신뢰도 향상
- **조건**:
  1. 가격 vs SMA20 위치
  2. RSI 상태 (과매수/과매도)
  3. 거래량 상태 (평균 대비)
- **신호**: 모든 조건 만족 시 STRONG 신호, 부분 만족 시 WEAK 신호

### 2.2 고급 전략 (Advanced Strategies)

#### 2.2.1 스마트 머니 플로우 전략

- **목적**: 기관투자자 자금 흐름 추적
- **분석 요소**:
  - 볼륨 프로파일: 가격대별 거래량 분포
  - 주문 흐름: 매수/매도 주문 균형
  - 기관 자금 흐름: 대량 거래 패턴
- **신호**: 기관 매집/분산 감지 시 매매 신호

#### 2.2.2 멀티 타임프레임 트렌드 전략

- **목적**: 여러 시간봉의 트렌드 일치성 확인
- **분석**: 15분, 1시간, 4시간, 1일 트렌드 방향
- **신호**: 모든 시간봉이 같은 방향일 때 강한 신호

#### 2.2.3 패턴 인식 전략

- **목적**: 차트 패턴 자동 감지
- **패턴**: 이중바닥, 헤드앤숄더, 삼각형 등
- **신호**: 패턴 완성 시 해당 방향 매매 신호

#### 2.2.4 엘리어트 웨이브 전략

- **목적**: 엘리어트 웨이브 이론 기반 분석
- **분석**: 현재 웨이브 위치, 완성도, 수정 완료 여부
- **신호**: 웨이브 3, 5 구간 진입 신호

#### 2.2.5 데이 트레이딩 전략

- **목적**: 단기 매매에 최적화된 전략
- **특징**: 빠른 진입/청산, 단기 모멘텀 활용
- **신호**: 단기 과매수/과매도 반전 신호

---

## ⚡ 3. 실제 사용 중인 지표 및 전략

### 3.1 핵심 지표 (실시간 계산)

- ✅ **ATR**: 손절/익절 거리 계산
- ✅ **SMA20, SMA50**: 피벗 반전 전략
- ✅ **RSI**: 과매수/과매도 감지
- ✅ **거래량**: 급증 패턴 감지
- ✅ **현재가**: 실시간 가격 정보

### 3.2 핵심 전략 (자동매매 실행)

- ✅ **피벗 반전 전략**: 주요 진입 전략
  - 3개 조건 중 2개 만족 시 진입
  - ATR 기반 손절/익절 설정
  - 전체 자산 3배 레버리지 진입

### 3.3 보조 전략 (신호 생성)

- ✅ **이동평균 크로스오버**: 트렌드 확인
- ✅ **볼린저 밴드**: 변동성 분석
- ✅ **MACD**: 모멘텀 확인
- ✅ **삼중 확인**: 신뢰도 검증

### 3.4 고급 전략 (분석용)

- 🔄 **스마트 머니 플로우**: 기관 자금 흐름
- 🔄 **멀티 타임프레임**: 다중 시간봉 분석
- 🔄 **패턴 인식**: 차트 패턴 감지
- 🔄 **엘리어트 웨이브**: 웨이브 분석
- 🔄 **데이 트레이딩**: 단기 전략

---

## 🔄 4. 15분봉 실행 플로우 상세

### 4.1 이벤트 트리거

```typescript
// candle.saved 이벤트 수신
handleCandleSaved(event: CandleSavedEvent) {
  if (!isNewCandle) return; // 새로운 캔들만 처리

  // 1. ATR 계산 및 캐시 저장
  await this.calculateAndCacheATR(symbol);

  // 2. 기본 전략 분석 실행
  const basicResults = await this.basicStrategyService.executeAllBasicStrategies(symbol, timeframe);

  // 3. 고급 전략 분석 실행
  const advancedResults = await this.advancedStrategyService.executeAllAdvancedStrategies(symbol, timeframe);

  // 4. 종합 분석 결과 생성
  const analysisResult = await this.performComprehensiveAnalysis(symbol, timeframe);

  // 5. 분석 완료 이벤트 발송
  await this.emitAnalysisCompletedEvent(symbol, timeframe, analysisResult, candleData);
}
```

### 4.2 ATR 계산 프로세스

```typescript
calculateAndCacheATR(symbol: string) {
  // 1. 최신 200개 캔들 조회
  const candles = await this.getCandleData(symbol, 200);

  // 2. ATR 계산 (14기간)
  const atr = this.technicalIndicatorService.calculateATR(candles, 14);

  // 3. 손절/익절가 계산
  const stopLoss = atr * 2.8; // ATR 배수
  const takeProfit = atr * 1.3; // ATR 배수

  // 4. 캐시 저장
  this.cacheService.set(`atr:${symbol}`, atrResult);
}
```

### 4.3 전략 실행 순서

1. **기본 전략** (5개)
   - 이동평균 크로스오버
   - 볼린저 밴드 반전
   - MACD 크로스오버
   - 피벗 반전 ⭐
   - 삼중 확인

2. **고급 전략** (5개)
   - 스마트 머니 플로우
   - 멀티 타임프레임 트렌드
   - 패턴 인식
   - 엘리어트 웨이브
   - 데이 트레이딩

3. **종합 분석**
   - 모든 전략 결과 통합
   - 전체 신호 결정 (BUY/SELL/HOLD)
   - 신뢰도 점수 계산
