# ğŸš€ ìë™ë§¤ë§¤ ë™ì ì¡°ì ˆ ê°œì„  í”„ë¡œì„¸ìŠ¤

## ğŸ“‹ ëª©ì°¨

1. [í˜„ì¬ ìƒí™© ë¶„ì„](#í˜„ì¬-ìƒí™©-ë¶„ì„)
2. [ê°œì„  ëª©í‘œ](#ê°œì„ -ëª©í‘œ)
3. [êµ¬í˜„ ë‹¨ê³„](#êµ¬í˜„-ë‹¨ê³„)
4. [ê¸°ìˆ ì  ìƒì„¸](#ê¸°ìˆ ì -ìƒì„¸)
5. [API ì„¤ê³„](#api-ì„¤ê³„)
6. [í…ŒìŠ¤íŠ¸ ê³„íš](#í…ŒìŠ¤íŠ¸-ê³„íš)
7. [ë°°í¬ ë° ëª¨ë‹ˆí„°ë§](#ë°°í¬-ë°-ëª¨ë‹ˆí„°ë§)

---

## ğŸ” í˜„ì¬ ìƒí™© ë¶„ì„

### âŒ í˜„ì¬ ë¬¸ì œì 

#### 1. **ê³ ì • í¬ì§€ì…˜ í¬ê¸°**

```typescript
// src/auto-trading/service/AutoTradingService.ts
private calculatePositionSize(symbol: string, currentPrice: number): number {
  // TODO: ê³„ì¢Œ ì”ê³ ë¥¼ í™•ì¸í•˜ì—¬ ë™ì ìœ¼ë¡œ ê³„ì‚°
  // í˜„ì¬ëŠ” ê³ ì • $100 ë…¸ì…”ë„ ê°’ ì‚¬ìš©
  const notionalValue = 100; // USD
  const quantity = notionalValue / currentPrice;
  return quantity;
}
```

**ë¬¸ì œì **:

- ê³„ì¢Œ ì”ê³  ë¬´ì‹œ
- ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì—†ìŒ
- ì‹œì¥ ìƒí™© ë¬´ì‹œ
- ìˆ˜ìµ/ì†ì‹¤ì— ë”°ë¥¸ ì¡°ì ˆ ì—†ìŒ

#### 2. **ê³ ì • ì†ì ˆ/ìµì ˆ**

```typescript
// í˜„ì¬ ì„¤ì •
const stopLoss = currentPrice * (1 + 0.02); // ê³ ì • 2%
const takeProfit = currentPrice * (1 + 0.04); // ê³ ì • 4%
```

**ë¬¸ì œì **:

- ì‹œì¥ ë³€ë™ì„± ë¬´ì‹œ
- ATR ê¸°ë°˜ ë™ì  ì¡°ì ˆ ì—†ìŒ
- ë¦¬ìŠ¤í¬/ë¦¬ì›Œë“œ ë¹„ìœ¨ ê³ ì •

#### 3. **ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥**

- âœ… `FuturesService.getFuturesBalances()` - ì”ê³  ì¡°íšŒ ê°€ëŠ¥
- âœ… `TechnicalAnalysisController.calculatePositionSize()` - ë¦¬ìŠ¤í¬ ê¸°ë°˜ ê³„ì‚° API
- âŒ AutoTradingServiceì—ì„œ í™œìš© ì•ˆí•¨

---

## ğŸ¯ ê°œì„  ëª©í‘œ

### 1. **ë™ì  í¬ì§€ì…˜ í¬ê¸°**

- ê³„ì¢Œ ì”ê³  ê¸°ë°˜ ê³„ì‚°
- ë¦¬ìŠ¤í¬ ê´€ë¦¬ ë¹„ìœ¨ ì ìš©
- ì‹œì¥ ìƒí™©ì— ë”°ë¥¸ ì¡°ì ˆ
- Kelly Criterion ì ìš©

### 2. **ë™ì  ì†ì ˆ/ìµì ˆ**

- ATR ê¸°ë°˜ ë™ì  ê³„ì‚°
- ë³€ë™ì„±ì— ë”°ë¥¸ ì¡°ì ˆ
- ë¦¬ìŠ¤í¬/ë¦¬ì›Œë“œ ë¹„ìœ¨ ìµœì í™”

### 3. **ì‹¤ì‹œê°„ ì„¤ì • ì¡°ì ˆ**

- APIë¥¼ í†µí•œ ì‹¤ì‹œê°„ ì„¤ì • ë³€ê²½
- ì›¹ ëŒ€ì‹œë³´ë“œ ì—°ë™
- ì¡°ê±´ë¶€ ìë™ ì¡°ì ˆ

---

## ğŸ› ï¸ êµ¬í˜„ ë‹¨ê³„

### **1ë‹¨ê³„: ê¸°ë³¸ ë™ì  í¬ì§€ì…˜ í¬ê¸° êµ¬í˜„**

#### 1.1 í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```bash
# .env íŒŒì¼ ì¶”ê°€
# í¬ì§€ì…˜ í¬ê¸° ì„¤ì •
POSITION_SIZE_TYPE=DYNAMIC          # FIXED | DYNAMIC
POSITION_SIZE_PERCENT=2             # ê³„ì¢Œ ì”ê³ ì˜ 2%
POSITION_SIZE_MAX_AMOUNT=1000       # ìµœëŒ€ $1000
POSITION_SIZE_MIN_AMOUNT=50         # ìµœì†Œ $50

# ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì„¤ì •
RISK_MANAGEMENT_ENABLED=true        # ë¦¬ìŠ¤í¬ ê´€ë¦¬ í™œì„±í™”
MAX_RISK_PER_TRADE=2               # ê±°ë˜ë‹¹ ìµœëŒ€ ë¦¬ìŠ¤í¬ 2%
MAX_DAILY_RISK=5                   # ì¼ì¼ ìµœëŒ€ ë¦¬ìŠ¤í¬ 5%
```

#### 1.2 AutoTradingService ê°œì„ 

```typescript
// src/auto-trading/service/AutoTradingService.ts
class AutoTradingService {
  private async calculateDynamicPositionSize(
    symbol: string,
    currentPrice: number,
  ): Promise<number> {
    // 1. ê³„ì¢Œ ì”ê³  ì¡°íšŒ
    const balances = await this.futuresService.getFuturesBalances();
    const usdtBalance =
      balances.find((b) => b.asset === 'USDT')?.availableBalance || 0;

    // 2. ì„¤ì •ê°’ ì¡°íšŒ
    const positionType = this.configService.get(
      'POSITION_SIZE_TYPE',
      'DYNAMIC',
    );
    const percentage = this.configService.get('POSITION_SIZE_PERCENT', 2) / 100;
    const maxAmount = this.configService.get('POSITION_SIZE_MAX_AMOUNT', 1000);
    const minAmount = this.configService.get('POSITION_SIZE_MIN_AMOUNT', 50);

    if (positionType === 'FIXED') {
      return 100; // ê¸°ì¡´ ê³ ì •ê°’
    }

    // 3. ë™ì  ê³„ì‚°
    const calculatedAmount = usdtBalance * percentage;
    const finalAmount = Math.max(
      minAmount,
      Math.min(calculatedAmount, maxAmount),
    );
    const quantity = finalAmount / currentPrice;

    this.logger.log(
      `ğŸ’° [${symbol}] ë™ì  í¬ì§€ì…˜ í¬ê¸°: ${usdtBalance}USD â†’ ${finalAmount}USD (${quantity.toFixed(6)})`,
    );

    return quantity;
  }
}
```

### **2ë‹¨ê³„: ATR ê¸°ë°˜ ë™ì  ì†ì ˆ/ìµì ˆ**

#### 2.1 ATR ê³„ì‚° ì„œë¹„ìŠ¤

```typescript
// src/technical-analysis/service/TechnicalIndicatorService.ts
class TechnicalIndicatorService {
  async calculateATR(symbol: string, period: number = 14): Promise<number> {
    const candles = await this.candleRepository.findLatestCandles(
      symbol,
      'FUTURES',
      period + 1,
    );

    const trueRanges = [];
    for (let i = 1; i < candles.length; i++) {
      const high = candles[i].high;
      const low = candles[i].low;
      const prevClose = candles[i - 1].close;

      const tr1 = high - low;
      const tr2 = Math.abs(high - prevClose);
      const tr3 = Math.abs(low - prevClose);

      trueRanges.push(Math.max(tr1, tr2, tr3));
    }

    const atr = trueRanges.reduce((sum, tr) => sum + tr, 0) / trueRanges.length;
    return atr;
  }
}
```

#### 2.2 ë™ì  ì†ì ˆ/ìµì ˆ ê³„ì‚°

```typescript
// src/auto-trading/service/AutoTradingService.ts
class AutoTradingService {
  private async calculateDynamicStopLoss(
    symbol: string,
    currentPrice: number,
    side: 'LONG' | 'SHORT',
  ): Promise<number> {
    const atr = await this.indicatorService.calculateATR(symbol, 14);
    const atrMultiplier = this.configService.get('STOP_LOSS_ATR_MULTIPLIER', 2);
    const minPercent = this.configService.get('STOP_LOSS_MIN_PERCENT', 1) / 100;
    const maxPercent = this.configService.get('STOP_LOSS_MAX_PERCENT', 5) / 100;

    const atrDistance = atr * atrMultiplier;
    const percentDistance = currentPrice * minPercent;
    const stopLossDistance = Math.max(atrDistance, percentDistance);

    if (side === 'LONG') {
      return currentPrice - stopLossDistance;
    } else {
      return currentPrice + stopLossDistance;
    }
  }

  private async calculateDynamicTakeProfit(
    symbol: string,
    currentPrice: number,
    side: 'LONG' | 'SHORT',
  ): Promise<number> {
    const stopLoss = await this.calculateDynamicStopLoss(
      symbol,
      currentPrice,
      side,
    );
    const riskRewardRatio = this.configService.get(
      'TAKE_PROFIT_RISK_REWARD_RATIO',
      2,
    );

    const stopLossDistance = Math.abs(currentPrice - stopLoss);
    const takeProfitDistance = stopLossDistance * riskRewardRatio;

    if (side === 'LONG') {
      return currentPrice + takeProfitDistance;
    } else {
      return currentPrice - takeProfitDistance;
    }
  }
}
```

### **3ë‹¨ê³„: Kelly Criterion ì ìš©**

#### 3.1 ê±°ë˜ í†µê³„ ìˆ˜ì§‘

```typescript
// src/transaction/service/TransactionService.ts
class TransactionService {
  async getTradingStatistics(
    symbol: string,
    days: number = 30,
  ): Promise<TradingStats> {
    const trades = await this.getTradesBySymbol(symbol, days);

    const totalTrades = trades.length;
    const winningTrades = trades.filter((t) => t.pnl > 0);
    const losingTrades = trades.filter((t) => t.pnl < 0);

    const winRate = winningTrades.length / totalTrades;
    const avgWin =
      winningTrades.reduce((sum, t) => sum + t.pnl, 0) / winningTrades.length;
    const avgLoss = Math.abs(
      losingTrades.reduce((sum, t) => sum + t.pnl, 0) / losingTrades.length,
    );

    return { winRate, avgWin, avgLoss, totalTrades };
  }
}
```

#### 3.2 Kelly Criterion ê³„ì‚°

```typescript
// src/auto-trading/service/AutoTradingService.ts
class AutoTradingService {
  private calculateKellyPositionSize(stats: TradingStats): number {
    const { winRate, avgWin, avgLoss } = stats;

    if (avgLoss === 0 || winRate === 0) return 0.02; // ê¸°ë³¸ 2%

    // Kelly ê³µì‹: f = (bp - q) / b
    const b = avgWin / avgLoss; // ìˆ˜ìµ/ì†ì‹¤ ë¹„ìœ¨
    const p = winRate; // ìŠ¹ë¥ 
    const q = 1 - winRate; // íŒ¨ë¥ 

    const kellyFraction = (b * p - q) / b;

    // ë³´ìˆ˜ì  Kelly (50% ì ìš©)
    const conservativeKelly = kellyFraction * 0.5;

    // ìµœì†Œ 0%, ìµœëŒ€ 10% ì œí•œ
    return Math.max(0, Math.min(conservativeKelly, 0.1));
  }
}
```

### **4ë‹¨ê³„: API ë° ëŒ€ì‹œë³´ë“œ**

#### 4.1 ì„¤ì • ê´€ë¦¬ API

```typescript
// src/auto-trading/web/AutoTradingController.ts
@Controller('auto-trading')
export class AutoTradingController {
  @Get('config')
  async getTradingConfig() {
    return {
      positionSize: {
        type: this.configService.get('POSITION_SIZE_TYPE', 'DYNAMIC'),
        percentage: this.configService.get('POSITION_SIZE_PERCENT', 2),
        maxAmount: this.configService.get('POSITION_SIZE_MAX_AMOUNT', 1000),
        minAmount: this.configService.get('POSITION_SIZE_MIN_AMOUNT', 50),
      },
      stopLoss: {
        type: this.configService.get('STOP_LOSS_TYPE', 'ATR_BASED'),
        atrMultiplier: this.configService.get('STOP_LOSS_ATR_MULTIPLIER', 2),
        minPercent: this.configService.get('STOP_LOSS_MIN_PERCENT', 1),
        maxPercent: this.configService.get('STOP_LOSS_MAX_PERCENT', 5),
      },
      takeProfit: {
        type: this.configService.get('TAKE_PROFIT_TYPE', 'RISK_REWARD'),
        riskRewardRatio: this.configService.get(
          'TAKE_PROFIT_RISK_REWARD_RATIO',
          2,
        ),
        minPercent: this.configService.get('TAKE_PROFIT_MIN_PERCENT', 2),
        maxPercent: this.configService.get('TAKE_PROFIT_MAX_PERCENT', 10),
      },
    };
  }

  @Put('config')
  async updateTradingConfig(@Body() config: TradingConfigDto) {
    await this.autoTradingService.updateConfig(config);
    return { message: 'ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.' };
  }
}
```

#### 4.2 ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ

```typescript
@Get('dashboard')
async getTradingDashboard() {
  const config = await this.getTradingConfig();
  const balances = await this.futuresService.getFuturesBalances();
  const positions = await this.futuresService.getActivePositions();
  const stats = await this.transactionService.getTradingStatistics('ALL', 30);

  return {
    config,
    account: {
      balances,
      totalBalance: balances.reduce((sum, b) => sum + b.totalBalance, 0),
      availableBalance: balances.reduce((sum, b) => sum + b.availableBalance, 0),
    },
    positions,
    performance: {
      totalTrades: stats.totalTrades,
      winRate: stats.winRate * 100,
      avgWin: stats.avgWin,
      avgLoss: stats.avgLoss,
      profitFactor: stats.avgWin / stats.avgLoss,
    }
  };
}
```

---

## ğŸ”§ ê¸°ìˆ ì  ìƒì„¸

### **í™˜ê²½ë³€ìˆ˜ ì„¤ì •**

#### **í¬ì§€ì…˜ í¬ê¸° ì„¤ì •**

```bash
# í¬ì§€ì…˜ í¬ê¸° íƒ€ì… (FIXED | DYNAMIC)
POSITION_SIZE_TYPE=DYNAMIC

# ê³„ì¢Œ ì”ê³  ëŒ€ë¹„ ë¹„ìœ¨ (%)
POSITION_SIZE_PERCENT=2

# ìµœëŒ€/ìµœì†Œ í¬ì§€ì…˜ í¬ê¸° (USD)
POSITION_SIZE_MAX_AMOUNT=1000
POSITION_SIZE_MIN_AMOUNT=50

# Kelly Criterion ì„¤ì •
KELLY_CONSERVATIVE_FACTOR=0.5
KELLY_MAX_POSITION_SIZE=0.1
```

#### **ì†ì ˆ/ìµì ˆ ì„¤ì •**

```bash
# ì†ì ˆ íƒ€ì… (FIXED_PERCENT | ATR_BASED)
STOP_LOSS_TYPE=ATR_BASED

# ATR ê¸°ë°˜ ì†ì ˆ ì„¤ì •
STOP_LOSS_ATR_MULTIPLIER=2
STOP_LOSS_MIN_PERCENT=1
STOP_LOSS_MAX_PERCENT=5

# ìµì ˆ íƒ€ì… (FIXED_PERCENT | RISK_REWARD)
TAKE_PROFIT_TYPE=RISK_REWARD

# ë¦¬ìŠ¤í¬/ë¦¬ì›Œë“œ ë¹„ìœ¨
TAKE_PROFIT_RISK_REWARD_RATIO=2
TAKE_PROFIT_MIN_PERCENT=2
TAKE_PROFIT_MAX_PERCENT=10
```

#### **ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì„¤ì •**

```bash
# ë¦¬ìŠ¤í¬ ê´€ë¦¬ í™œì„±í™”
RISK_MANAGEMENT_ENABLED=true

# ê±°ë˜ë‹¹ ìµœëŒ€ ë¦¬ìŠ¤í¬ (%)
MAX_RISK_PER_TRADE=2

# ì¼ì¼ ìµœëŒ€ ë¦¬ìŠ¤í¬ (%)
MAX_DAILY_RISK=5

# ìµœëŒ€ ë™ì‹œ í¬ì§€ì…˜ ìˆ˜
MAX_CONCURRENT_POSITIONS=3
```

### **ë°ì´í„° êµ¬ì¡°**

#### **TradingConfigDto**

```typescript
interface TradingConfigDto {
  positionSize: {
    type: 'FIXED' | 'DYNAMIC';
    percentage: number;
    maxAmount: number;
    minAmount: number;
  };
  stopLoss: {
    type: 'FIXED_PERCENT' | 'ATR_BASED';
    atrMultiplier: number;
    minPercent: number;
    maxPercent: number;
  };
  takeProfit: {
    type: 'FIXED_PERCENT' | 'RISK_REWARD';
    riskRewardRatio: number;
    minPercent: number;
    maxPercent: number;
  };
  riskManagement: {
    enabled: boolean;
    maxRiskPerTrade: number;
    maxDailyRisk: number;
    maxConcurrentPositions: number;
  };
}
```

#### **TradingStats**

```typescript
interface TradingStats {
  totalTrades: number;
  winRate: number;
  avgWin: number;
  avgLoss: number;
  profitFactor: number;
  sharpeRatio: number;
  maxDrawdown: number;
}
```

---

## ğŸ“¡ API ì„¤ê³„

### **ì„¤ì • ê´€ë¦¬ API**

#### **GET /auto-trading/config**

í˜„ì¬ ìë™ë§¤ë§¤ ì„¤ì • ì¡°íšŒ

**ì‘ë‹µ ì˜ˆì‹œ**:

```json
{
  "success": true,
  "data": {
    "positionSize": {
      "type": "DYNAMIC",
      "percentage": 2,
      "maxAmount": 1000,
      "minAmount": 50
    },
    "stopLoss": {
      "type": "ATR_BASED",
      "atrMultiplier": 2,
      "minPercent": 1,
      "maxPercent": 5
    },
    "takeProfit": {
      "type": "RISK_REWARD",
      "riskRewardRatio": 2,
      "minPercent": 2,
      "maxPercent": 10
    }
  }
}
```

#### **PUT /auto-trading/config**

ìë™ë§¤ë§¤ ì„¤ì • ì—…ë°ì´íŠ¸

**ìš”ì²­ ì˜ˆì‹œ**:

```json
{
  "positionSize": {
    "type": "DYNAMIC",
    "percentage": 3,
    "maxAmount": 1500
  },
  "stopLoss": {
    "atrMultiplier": 2.5
  }
}
```

### **ëŒ€ì‹œë³´ë“œ API**

#### **GET /auto-trading/dashboard**

ì‹¤ì‹œê°„ ìë™ë§¤ë§¤ ëŒ€ì‹œë³´ë“œ

**ì‘ë‹µ ì˜ˆì‹œ**:

```json
{
  "success": true,
  "data": {
    "config": {
      /* ì„¤ì • ì •ë³´ */
    },
    "account": {
      "totalBalance": 10000,
      "availableBalance": 9500,
      "usedMargin": 500
    },
    "positions": [
      {
        "symbol": "BTCUSDT",
        "side": "LONG",
        "quantity": 0.001,
        "entryPrice": 50000,
        "currentPrice": 51000,
        "pnl": 10,
        "pnlPercent": 2
      }
    ],
    "performance": {
      "totalTrades": 150,
      "winRate": 65,
      "avgWin": 3.2,
      "avgLoss": 1.8,
      "profitFactor": 1.78
    }
  }
}
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê³„íš

### **1ë‹¨ê³„: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**

#### **í¬ì§€ì…˜ í¬ê¸° ê³„ì‚° í…ŒìŠ¤íŠ¸**

```typescript
describe('calculateDynamicPositionSize', () => {
  it('ê³„ì¢Œ ì”ê³  ê¸°ë°˜ìœ¼ë¡œ ì˜¬ë°”ë¥¸ í¬ì§€ì…˜ í¬ê¸°ë¥¼ ê³„ì‚°í•´ì•¼ í•¨', async () => {
    // Given
    const mockBalance = 10000; // $10,000
    const mockPrice = 50000; // $50,000
    const expectedPercentage = 0.02; // 2%

    // When
    const result = await service.calculateDynamicPositionSize(
      'BTCUSDT',
      mockPrice,
    );

    // Then
    const expectedAmount = mockBalance * expectedPercentage;
    const expectedQuantity = expectedAmount / mockPrice;
    expect(result).toBeCloseTo(expectedQuantity, 6);
  });
});
```

#### **ATR ê¸°ë°˜ ì†ì ˆ ê³„ì‚° í…ŒìŠ¤íŠ¸**

```typescript
describe('calculateDynamicStopLoss', () => {
  it('ATR ê¸°ë°˜ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ì†ì ˆê°€ë¥¼ ê³„ì‚°í•´ì•¼ í•¨', async () => {
    // Given
    const mockATR = 1000;
    const mockPrice = 50000;
    const mockMultiplier = 2;

    // When
    const result = await service.calculateDynamicStopLoss(
      'BTCUSDT',
      mockPrice,
      'LONG',
    );

    // Then
    const expectedStopLoss = mockPrice - mockATR * mockMultiplier;
    expect(result).toBe(expectedStopLoss);
  });
});
```

### **2ë‹¨ê³„: í†µí•© í…ŒìŠ¤íŠ¸**

#### **ì „ì²´ ìë™ë§¤ë§¤ í”Œë¡œìš° í…ŒìŠ¤íŠ¸**

```typescript
describe('AutoTrading Flow', () => {
  it('ì‹ í˜¸ ë°œìƒ ì‹œ ë™ì  ì„¤ì •ìœ¼ë¡œ í¬ì§€ì…˜ì„ ì§„ì…í•´ì•¼ í•¨', async () => {
    // Given
    const signal = { symbol: 'BTCUSDT', signal: 'STRONG_BUY' };
    const mockBalance = 10000;

    // When
    await service.handleTradingSignal(signal);

    // Then
    const position = await futuresService.getPosition('BTCUSDT');
    expect(position).toBeDefined();
    expect(position.quantity).toBeGreaterThan(0);

    // ë™ì  ì„¤ì • í™•ì¸
    const expectedAmount = mockBalance * 0.02; // 2%
    expect(position.notionalValue).toBeCloseTo(expectedAmount, 2);
  });
});
```

### **3ë‹¨ê³„: ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**

#### **ì‘ë‹µ ì‹œê°„ í…ŒìŠ¤íŠ¸**

```typescript
describe('Performance Tests', () => {
  it('í¬ì§€ì…˜ í¬ê¸° ê³„ì‚°ì´ 100ms ì´ë‚´ì— ì™„ë£Œë˜ì–´ì•¼ í•¨', async () => {
    const startTime = Date.now();
    await service.calculateDynamicPositionSize('BTCUSDT', 50000);
    const endTime = Date.now();

    expect(endTime - startTime).toBeLessThan(100);
  });
});
```

---

## ğŸš€ ë°°í¬ ë° ëª¨ë‹ˆí„°ë§

### **ë°°í¬ ë‹¨ê³„**

#### **1. í™˜ê²½ë³€ìˆ˜ ì„¤ì •**

```bash
# .env.production íŒŒì¼ ìƒì„±
POSITION_SIZE_TYPE=DYNAMIC
POSITION_SIZE_PERCENT=2
POSITION_SIZE_MAX_AMOUNT=1000
STOP_LOSS_TYPE=ATR_BASED
STOP_LOSS_ATR_MULTIPLIER=2
TAKE_PROFIT_TYPE=RISK_REWARD
TAKE_PROFIT_RISK_REWARD_RATIO=2
```

#### **2. ì ì§„ì  ë°°í¬**

1. **1ë‹¨ê³„**: ê¸°ì¡´ ì„¤ì • ìœ ì§€, ë¡œê¹…ë§Œ ì¶”ê°€
2. **2ë‹¨ê³„**: ë™ì  í¬ì§€ì…˜ í¬ê¸° í™œì„±í™” (ì†Œì•¡ìœ¼ë¡œ í…ŒìŠ¤íŠ¸)
3. **3ë‹¨ê³„**: ATR ê¸°ë°˜ ì†ì ˆ/ìµì ˆ í™œì„±í™”
4. **4ë‹¨ê³„**: Kelly Criterion ì ìš©

#### **3. ë¡¤ë°± ê³„íš**

```bash
# ê¸´ê¸‰ ë¡¤ë°± ëª…ë ¹ì–´
POSITION_SIZE_TYPE=FIXED
STOP_LOSS_TYPE=FIXED_PERCENT
TAKE_PROFIT_TYPE=FIXED_PERCENT
```

### **ëª¨ë‹ˆí„°ë§ ì§€í‘œ**

#### **ì„±ëŠ¥ ì§€í‘œ**

- í¬ì§€ì…˜ í¬ê¸° ê³„ì‚° ì‘ë‹µ ì‹œê°„
- ATR ê³„ì‚° ì‘ë‹µ ì‹œê°„
- API ì‘ë‹µ ì‹œê°„

#### **ê±°ë˜ ì§€í‘œ**

- í‰ê·  í¬ì§€ì…˜ í¬ê¸°
- ì†ì ˆ/ìµì ˆ ì‹¤í–‰ ë¹„ìœ¨
- ë¦¬ìŠ¤í¬/ë¦¬ì›Œë“œ ë¹„ìœ¨ ë‹¬ì„±ë¥ 
- Kelly Criterion ì ìš© íš¨ê³¼

#### **ì•Œë¦¼ ì„¤ì •**

```typescript
// í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì˜ˆì‹œ
await this.notificationService.sendTelegramMessage(
  `ğŸš¨ ìë™ë§¤ë§¤ ì„¤ì • ë³€ê²½\n` +
    `í¬ì§€ì…˜ í¬ê¸°: ${oldConfig.percentage}% â†’ ${newConfig.percentage}%\n` +
    `ì†ì ˆ: ${oldConfig.atrMultiplier}ë°° â†’ ${newConfig.atrMultiplier}ë°°\n` +
    `ìµì ˆ: ${oldConfig.riskRewardRatio}:1 â†’ ${newConfig.riskRewardRatio}:1`,
);
```

---

## ğŸ“ˆ ê¸°ëŒ€ íš¨ê³¼

### **1. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ê°œì„ **

- ê³„ì¢Œ ì”ê³ ì— ë§ëŠ” ì ì ˆí•œ í¬ì§€ì…˜ í¬ê¸°
- ì‹œì¥ ë³€ë™ì„±ì— ë”°ë¥¸ ë™ì  ì†ì ˆ/ìµì ˆ
- ì¼ì¼ ë¦¬ìŠ¤í¬ í•œë„ ê´€ë¦¬

### **2. ìˆ˜ìµë¥  í–¥ìƒ**

- Kelly Criterionì„ í†µí•œ ìµœì  í¬ì§€ì…˜ í¬ê¸°
- ATR ê¸°ë°˜ ì •í™•í•œ ì†ì ˆ/ìµì ˆ
- ë¦¬ìŠ¤í¬/ë¦¬ì›Œë“œ ë¹„ìœ¨ ìµœì í™”

### **3. ìš´ì˜ íš¨ìœ¨ì„±**

- ì‹¤ì‹œê°„ ì„¤ì • ì¡°ì ˆ
- ì›¹ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•œ ëª¨ë‹ˆí„°ë§
- ìë™í™”ëœ ë¦¬ìŠ¤í¬ ê´€ë¦¬

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### **ë¦¬ìŠ¤í¬ ê´€ë¦¬**

- ì´ˆê¸°ì—ëŠ” ë³´ìˆ˜ì  ì„¤ì •ìœ¼ë¡œ ì‹œì‘
- ì ì§„ì ìœ¼ë¡œ ì„¤ì • ì¡°ì •
- ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ í•„ìˆ˜

### **í…ŒìŠ¤íŠ¸**

- ì‹¤ì œ ê±°ë˜ ì „ ì¶©ë¶„í•œ ë°±í…ŒìŠ¤íŒ…
- ì†Œì•¡ìœ¼ë¡œ ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸
- ë‹¤ì–‘í•œ ì‹œì¥ ìƒí™©ì—ì„œ ê²€ì¦

### **ë°±ì—…**

- ê¸°ì¡´ ì„¤ì • ë°±ì—…
- ë¡¤ë°± ì ˆì°¨ ì¤€ë¹„
- ê¸´ê¸‰ ì •ì§€ ê¸°ëŠ¥ êµ¬í˜„

---

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

ê°œì„  í”„ë¡œì„¸ìŠ¤ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”!

**ë‹´ë‹¹ì**: ê°œë°œíŒ€  
**ì´ë©”ì¼**: dev@quant-backend.com  
**ìŠ¬ë™**: #auto-trading-improvement
